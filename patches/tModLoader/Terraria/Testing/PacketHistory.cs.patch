--- src/Terraria/Terraria/Testing/PacketHistory.cs
+++ src/tModLoader/Terraria/Testing/PacketHistory.cs
@@ -79,11 +_,9 @@
 
 		private string CreateDumpFileName() {
 			DateTime dateTime = DateTime.Now.ToLocalTime();
-#if CLIENT
-			const string Name = "Terraria";
-#else
-			const string Name = "TerrariaServer";
-#endif
+
+			string Name = Main.dedServ ? "TerrariaServer" : "Terraria";
+
 			return string.Format("Net_{0}_{1}_{2}_{3}.txt", Name, Main.versionNumber, dateTime.ToString("MM-dd-yy_HH-mm-ss-ffff", CultureInfo.InvariantCulture), Thread.CurrentThread.ManagedThreadId);
 		}
 
