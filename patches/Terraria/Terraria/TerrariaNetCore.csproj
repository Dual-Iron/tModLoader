<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="../ConfigurationNetCore.targets" />
  <Import Project="../../TerrariaSteamPath.targets" />
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <Version>1.4.0.5</Version>
    <Company>Re-Logic</Company>
    <Copyright>Copyright Â© 2020 Re-Logic</Copyright>
    <RootNamespace>Terraria</RootNamespace>
    <OutputName>Terraria</OutputName>
    <EffectivePlatform>Linux</EffectivePlatform>
  </PropertyGroup>
  <PropertyGroup Condition="$(Configuration.Contains('Server'))">
    <OutputType>Exe</OutputType>
    <OutputName>$(OutputName)Server</OutputName>
  </PropertyGroup>
  <PropertyGroup Condition="$(Configuration.Contains('Debug'))">
    <OutputName>$(OutputName)Debug</OutputName>
  </PropertyGroup>
  <PropertyGroup>
    <PdbFile>bin\$(OutputName)</PdbFile>
    <ApplicationIcon>Icon.ico</ApplicationIcon>
    <AssemblyName>$(OutputName)</AssemblyName>
    <TargetName>$(OutputName)</TargetName>
  </PropertyGroup>
  <ItemGroup>
    <FrameworkReference Include="Microsoft.WindowsDesktop.App" />
    <Reference Include="FNA">
      <HintPath>Libraries/FNA/FNA.dll</HintPath>
    </Reference>
    <Reference Include="Ionic.Zip.CF" />
    <Reference Include="Newtonsoft.Json" />
    <Reference Include="SteelSeriesEngineWrapper" />
    <Reference Include="RailSDK.Net">
      <HintPath>Libraries/Common/RailSDK.Net.dll</HintPath>
    </Reference>
    <ProjectReference Include="../ReLogic/ReLogicNetCore.csproj" />
    <EmbeddedResource Include="../ReLogic/bin/$(Configuration)/$(TargetFramework)/ReLogic.dll">
      <Link>Libraries/ReLogic/ReLogic.dll</Link>
      <LogicalName>Terraria.Libraries.ReLogic.ReLogic.dll</LogicalName>
    </EmbeddedResource>
    <Reference Include="Steamworks.NET">
      <HintPath>Libraries/Common/Steamworks.NET.dll</HintPath>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="GameContent/Creative/Content/*" />
    <EmbeddedResource Include="GameContent/Metadata/MaterialData/*" />
    <EmbeddedResource Include="GameContent/WorldBuilding/*" />
    <EmbeddedResource Include="IO/Data/*" />
    <EmbeddedResource Include="Libraries/DotNetZip/**" />
    <EmbeddedResource Include="Localization/Content/**" />
    <EmbeddedResource Include="Microsoft/**" />
  </ItemGroup>
  <ItemGroup>
    <None Remove="Libraries/Linux/**" />
    <None Remove="Libraries/Mac/**" />
    <None Remove="Libraries/Mono/**" />
    <None Remove="Libraries/Windows/**" />
    <None Remove="Libraries/XNA/**" />
  </ItemGroup>
  <Target Name="CopyToSteamDir" AfterTargets="Build">
    <ItemGroup>
      <BinFiles Include="$(TargetDir)**" />
      <LibFiles Include="Libraries/Native/**" />
      <SteamFiles Include="Libraries/Common/steam_appid.txt" />
    </ItemGroup>
    <Message Text="Copying $(OutputName) to Steam Dir..." Importance="high" />
    <!--Move important assembly refs to bin-->
    <Copy SourceFiles="@(SteamFiles)" DestinationFolder="$(TargetDir)" />
    <!--Move bin to steam-->
    <Copy SourceFiles="@(BinFiles)" DestinationFolder="$(TerrariaSteamPath)" />
    <!--Move lib folder to steam-->
    <Copy SourceFiles="@(LibFiles)" DestinationFolder="$(TerrariaSteamPath)/Libraries/Native/%(RecursiveDir)" />
  </Target>
</Project>
