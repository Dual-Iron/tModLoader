<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="../ConfigurationNetCore.targets" />
  <Import Project="../../TerrariaSteamPath.targets" />
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <Version>1.4.0.5</Version>
    <Company>Re-Logic</Company>
    <Copyright>Copyright Â© 2020 Re-Logic</Copyright>
    <RootNamespace>Terraria</RootNamespace>
    <OutputName>Terraria</OutputName>
    <EffectivePlatform>Linux</EffectivePlatform>
  </PropertyGroup>
  <PropertyGroup Condition="$(Configuration.Contains('Server'))">
    <OutputType>Exe</OutputType>
    <OutputName>$(OutputName)Server</OutputName>
  </PropertyGroup>
  <PropertyGroup>
    <PdbFile>bin\$(OutputName)</PdbFile>
    <ApplicationIcon>Icon.ico</ApplicationIcon>
    <AssemblyName>$(OutputName)</AssemblyName>
    <TargetName>$(OutputName)</TargetName>
  </PropertyGroup>
  <ItemGroup>
    <FrameworkReference Include="Microsoft.WindowsDesktop.App" />
    <Reference Include="FNA" />
    <Reference Include="Ionic.Zip.CF" />
    <Reference Include="Newtonsoft.Json" />
    <Reference Include="RailSDK.Net">
      <HintPath>Libraries/Native/$(EffectivePlatform)/RailSDK.Net.dll</HintPath>
      <!--May need updated for mac?-->
    </Reference>
    <ProjectReference Include="../ReLogic/ReLogicNetCore.csproj" />
    <EmbeddedResource Include="../ReLogic/bin/$(Configuration)/$(TargetFramework)/ReLogic.dll">
      <Link>Libraries/ReLogic/ReLogic.dll</Link>
      <LogicalName>Terraria.Libraries.ReLogic.ReLogic.dll</LogicalName>
    </EmbeddedResource>
    <Reference Include="Steamworks.NET">
      <HintPath>Libraries/Native/$(EffectivePlatform)/Steamworks.NET.dll</HintPath>
      <!--May need updated for mac?-->
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="GameContent/Creative/Content/*" />
    <EmbeddedResource Include="GameContent/Metadata/MaterialData/*" />
    <EmbeddedResource Include="GameContent/WorldBuilding/*" />
    <EmbeddedResource Include="IO/Data/*" />
    <EmbeddedResource Include="Libraries/DotNetZip/**" />
    <EmbeddedResource Include="Localization/Content/**" />
    <EmbeddedResource Include="Microsoft/**" />
  </ItemGroup>
  <ItemGroup>
    <None Remove="Libraries/Linux/**" />
    <None Remove="Libraries/Mac/**" />
    <None Remove="Libraries/Mono/**" />
    <None Remove="Libraries/Windows/**" />
    <None Remove="Libraries/XNA/**" />
    <None Remove="Libraries/FNA/**" />
  </ItemGroup>
  <Target Name="CopyToSteamDir" AfterTargets="Build">
    <ItemGroup>
      <BinFiles Include="$(TargetDir)**" />
      <LibFiles Include="Libraries/Native/**" />
    </ItemGroup>
    <Message Text="Copying $(OutputName) to Steam Dir..." Importance="high" />
    <Copy SourceFiles="@(BinFiles)" DestinationFolder="$(TerrariaSteamPath)" />
    <Copy SourceFiles="@(LibFiles)" DestinationFolder="$(TerrariaSteamPath)/Libraries/Native/%(RecursiveDir)" />
  </Target>
</Project>
